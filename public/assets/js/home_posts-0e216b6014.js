function noty_flash(e,t){new Noty({theme:"metroui",text:t,type:e,layout:"topRight",timeout:1e3}).show()}let create_post=()=>{let e=$("#new-post-form");e.submit(t=>{t.preventDefault(),$.ajax({type:"POST",url:"/posts/create",data:e.serialize(),success:e=>{let t=new_post_dom(e.data);$("#posts-container").prepend(t),comment_creator($(`#post_${e.data.post_id} .new-comment-form`)),add_like_button_functionality($("#like-"+e.data.post_id)),noty_flash("success","Post created Successfully!"),$("textarea")[0].value="",deletePost($(" .delete-post-button",t))},error:e=>{console.log(e.responseText)}})})},new_post_dom=e=>$(`\x3c!-- for loop for comment cards --\x3e\n    <div class="card w-100 mt-3 mb-2" id="post_${e.post_id}">\n        <div class="card-body">\n    \n            \x3c!-- options to delete a post and stuff --\x3e\n            \n            <div class="dropdown">\n                <a class="float-right" href="" id="more_options_${e.post_id}" data-toggle="dropdown" aria-haspopup="true"\n                    aria-expanded="false">\n                    <i class="fas fa-ellipsis-h"></i>\n                </a>\n                <div class="dropdown-menu" aria-labelledby="more_options_${e.post_id}">\n                    <a class="dropdown-item delete-post-button" href="/posts/destroy/${e.post_id}"><i\n                            class="fas fa-trash-alt"></i>\n                        Delete</a>\n                </div>\n            </div>\n            \n\n            <h5 class="card-title">${e.user_name}</h5>\n            <p class="card-text">${e.post_content}</p>\n            <div class="card-text mt-2"><small>${e.updatedAt.toString().substr(0,15)}</small></div>\n            <hr>\n            \n            <a href="/likes/toggle/?id=${e.post_id}&type=Post" id="like-${e.post_id}" class="like-buttons"\n            data-toggle="false" data-likes="0"><i class="far fa-heart"></i> <span>0</span></a>\n            &nbsp&nbsp&nbsp\n\n            <a data-toggle="collapse" href="#collapse_${e.post_id}" role="button" aria-expanded="false"\n                aria-controls="collapse${e.post_id}"><i class="far fa-comment"></i></a>&nbsp&nbsp&nbsp\n            <a href=""><i class="fas fa-paper-plane"></i></a>\n        </div>\n        <div class="collapse post-comments mr-2 ml-2" id="collapse_${e.post_id}">\n            \n            <form action="/comments/create" method="POST" class="new-comment-form">\n                <input type="text" class="form-control" placeholder="Add a new Comment..." aria-label="Username"\n                    aria-describedby="basic-addon1" name="content" required>\n                <input type="hidden" name="post" value="${e.post_id}">\n                <button type="submit" class="btn btn-primary btn-sm mt-2 mb-2 mr-2">Add Comment</button>\n            </form>\n            \x3c!-- comments list container --\x3e\n            <hr>\n            <div class="post-comments-lister-list pl-4 pr-4">\n                <div id="post-comments-${e.post_id}">\n                \n                </div>\n            </div>\n            \n        </div>\n    </div>`),deletePost=e=>{$(e).click(t=>{t.preventDefault(),$.ajax({type:"GET",url:$(e).prop("href"),success:e=>{$("#post_"+e.data.post_id).remove(),noty_flash("success","Post deleted Successfully")},error:e=>{console.log(e.responseText),noty_flash("error","There was some error in deleting the post")}})})},apply_dynamic_delete_to_existing_posts=function(){for(let e of $(".delete-post-button"))deletePost(e)};apply_dynamic_delete_to_existing_posts(),create_post();let comment_creator=function(e){e.submit(t=>{t.preventDefault(),$.ajax({type:"POST",url:"/comments/create",data:e.serialize(),success:e=>{let t=new_comment_dom(e.data);$("#post-comments-"+e.data.post_id).prepend(t),$(`#post_${e.data.post_id} .new-comment-form input`)[0].value="",noty_flash("success","Comment posted Successfully!"),add_like_button_functionality($("#like-"+e.data.comment_id)),delete_comment($(" .delete-comment-button",t))},error:e=>{noty_flash("success","Error in posting a comment!"),console.log(e.responseText)}})})},new_comment_dom=e=>$(`\x3c!-- for deleting a comment --\x3e\n    <div id="comment_id_${e.comment_id}">\n        <div class="dropdown">\n            <a class="float-right" href="" id="more_options_${e.comment_id}" data-toggle="dropdown"\n                aria-haspopup="true" aria-expanded="false">\n                <i class="fas fa-ellipsis-h"></i>\n            </a>\n            <div class="dropdown-menu" aria-labelledby="more_options_${e.comment_id}">\n                <a class="dropdown-item delete-comment-button" href="/comments/destroy/${e.comment_id}"><i\n                        class="fas fa-trash-alt"></i>\n                    Delete</a>\n            </div>\n        </div>\n        <b>${e.user_name}</b>\n        <p>\n            ${e.comment_content}\n        </p>\n\n        <div class="align-middle action-buttons">\n            \x3c!-- like button on post --\x3e\n            <a href="/likes/toggle/?id=${e.comment_id}&type=Comment" id="like-${e.comment_id}" class="like-buttons"\n                data-likes="0" data-toggle="false"><i class="far fa-heart"></i> <span>0</span> </a> &nbsp\n            \x3c!-- comment button on post --\x3e\n            <a data-toggle="collapse" href="#collapse${e.comment_id}" role="button" aria-expanded="false"\n            aria-controls="collapse${e.comment_id}"><i class="far fa-comment"></i></a>&nbsp\n            \x3c!-- send button on post --\x3e\n            <a href=""><i class="fas fa-paper-plane"></i></a>\n        </div>\n\n        <hr>\n    </div>`),delete_comment=e=>{$(e).click(t=>{t.preventDefault(),$.ajax({type:"GET",url:$(e).prop("href"),success:e=>{$("#comment_id_"+e.data.comment_id).remove(),noty_flash("success","Comment deleted Successfully")},error:e=>{console.log(e.responseText),noty_flash("error","There was some error in deleting the post!")}})})},apply_dynamic_comment_delete_to_existing_comments=e=>{delete_comment(e)};for(let e of $(".delete-comment-button"))apply_dynamic_comment_delete_to_existing_comments(e);for(let e of $(".new-comment-form"))comment_creator($(e));let add_like_button_functionality=e=>{e.click((function(t){t.preventDefault(),$.ajax({type:"GET",url:e.attr("href")}).done((function(t){let n=e.attr("data-likes");console.log(n),n=t.data.deleted?parseInt(n)-1:parseInt(n)+1,e.attr("data-likes",n),e.find("span").html(n)})).fail((function(e){e&&console.log("error in completing the ajax request")}))}))};